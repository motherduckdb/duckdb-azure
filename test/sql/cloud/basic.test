# name: test/sql/cloud/basic.test
# description: confirm queried data is correct
# group: [cloud]

require azure

require parquet

require-env AZ_STORAGE_ACCOUNT

require-env AZ_DATA_DIR

require-env ABFSS_STORAGE_ACCOUNT

require-env ABFSS_DATA_DIR

require-env AZURE_AUTH_ENV 1


statement ok
set allow_persistent_secrets=false

statement ok
CREATE SECRET az1 (
    TYPE AZURE,
    PROVIDER CREDENTIAL_CHAIN,
    ACCOUNT_NAME '${AZ_STORAGE_ACCOUNT}'
)

query I nosort r1
FROM 'az://${AZ_DATA_DIR}/l.parquet';

query I nosort r1
FROM './data/l.parquet'



statement ok
CREATE SECRET abfss1 (
    TYPE AZURE,
    PROVIDER CREDENTIAL_CHAIN,
    ACCOUNT_NAME '${ABFSS_STORAGE_ACCOUNT}'
)

query I nosort r1
FROM 'az://${ABFSS_DATA_DIR}/l.parquet';

query I nosort r1
FROM './data/l.parquet'
